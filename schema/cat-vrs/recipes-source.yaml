$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://w3id.org/ga4gh/schema/cat-vrs/1.x/recipes-source.yaml"
title: GA4GH-Cat-VRS-Recipe-Definitions
type: object

imports:
  gks.core-im: ../gks-core/gks-core-source.yaml
  vrs: ../vrs/vrs-source.yaml
  cat-vrs: ./cat-vrs-source.yaml

$defs:
  ProteinSequenceConsequence:
    description: >-
      A change that occurs in a protein sequence as a result of genomic changes. Due to the degenerate nature
      of the genetic code, there are often several genomic changes that can cause a protein sequence consequence.
      The protein sequence consequence, like a :ref:`CanonicalAllele`, is defined by an
      `Allele <https://vrs.ga4gh.org/en/2.x/concepts/MolecularVariation/Allele.html#>`_
      that is representative of a collection of congruent Protein Alleles that share the same altered codon(s).
    allOf:
      - $ref: "/ga4gh/schema/cat-vrs/1.x/json/CategoricalVariant"
      - properties:
          constraints:
            contains:
              allOf:
                - $ref: "/ga4gh/schema/cat-vrs/1.x/json/DefiningAlleleConstraint"
                - type: object
                  properties:
                    relations:
                      allOf:
                        - contains:
                            const: translates_from
                        - contains:
                            const: translates_from_reading_frame
                      maxContains: 2

  CanonicalAllele:
    maturity: draft
    description: >-
      A canonical allele is defined by an `Allele <https://vrs.ga4gh.org/en/2.x/concepts/MolecularVariation/Allele.html#>`_
      that is representative of a collection of congruent Alleles, each of which depict the same nucleic acid
      change on different underlying reference sequences. Congruent representations of an Allele often exist
      across different genome assemblies and associated cDNA transcript representations.
    allOf:
      - $ref: "/ga4gh/schema/cat-vrs/1.x/core/CategoricalVariant"
      - properties:
          constraints:
            minItems: 1
            maxItems: 1
            contains:
              allOf:
                - $ref: "/ga4gh/schema/cat-vrs/1.x/json/DefiningAlleleConstraint"
                - type: object
                  properties:
                    relations:
                      allOf:
                        - contains:
                            const: liftover_to
                        - contains:
                            const: transcribes_to
                      maxContains: 2

  CategoricalCnv:
    maturity: draft
    description: >-
      A representation of the constraints for matching knowledge about CNVs.
    allOf:
      - $ref: "/ga4gh/schema/cat-vrs/1.x/json/CategoricalVariant"
      - properties:
          constraints:
            description: >-
              The constraints array must contain exactly two items:
              a DefiningLocationConstraint and either a CopyChangeConstraint
              or CopyCountConstraint.
            minItems: 2
            maxItems: 2
            contains:
              allOf:
                - $ref: "/ga4gh/schema/cat-vrs/1.x/json/DefiningLocationConstraint"
                - type: object
                  properties:
                    relations:
                      contains:
                        const: liftover_to
            contains:
              oneOf:
                - $ref: "/ga4gh/schema/cat-vrs/1.x/json/CopyCountConstraint"
                - $ref: "/ga4gh/schema/cat-vrs/1.x/json/CopyChangeConstraint"
        required:
          - constraints